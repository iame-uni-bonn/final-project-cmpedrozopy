#Pytask for processing the distance data
import pandas as pd
import pytask

from project_mp.config import BLD, SRC
from project_mp.data_management.process_distance_data import (
    process_distance_data,
)

def task_process_distance_data(
        #script = SRC / "data_management" / "process_distance_data.py",
        data = SRC / "data" / "Mission_coordinatesok.csv",
        produces = BLD / "data" / "distance_to_missions.pkl"
):
    """Clean the distance data set."""
    data = pd.read_csv(data, encoding='latin1')
    data = process_distance_data(data)
    data.to_pickle(produces)
